@use "config" as *;
@use "variables" as *;
@use "functions" as *;
@use "mixins/border-radius" as *;
@use "mixins/transition" as *;
@use "mixins/focus-ring" as *;

// scss-docs-start accordion-variables
$accordion-padding-y:                     1rem !default;
$accordion-padding-x:                     1.25rem !default;
$accordion-color:                         var(--fg-body) !default;
$accordion-bg:                            var(--bg-body) !default;
$accordion-border-width:                  var(--border-width) !default;
$accordion-border-color:                  var(--border-color) !default;
$accordion-border-radius:                 var(--border-radius-lg) !default;
$accordion-inner-border-radius:           calc(#{$accordion-border-radius} - #{$accordion-border-width}) !default;

$accordion-body-padding-y:                $accordion-padding-y !default;
$accordion-body-padding-x:                $accordion-padding-x !default;

$accordion-button-padding-y:              $accordion-padding-y !default;
$accordion-button-padding-x:              $accordion-padding-x !default;
$accordion-button-color:                  var(--fg-2) !default;
$accordion-button-bg:                     var(--accordion-bg) !default;
$accordion-transition:                    color .15s ease-in-out, background-color .15s ease-in-out, border-radius .15s ease !default;
$accordion-button-active-bg:              var(--bg-2) !default;
$accordion-button-active-color:           var(--fg) !default;

$accordion-icon-width:                    1rem !default;
$accordion-icon-transition:               transform .2s ease-in-out !default;
$accordion-icon-transform:                rotate(-180deg) !default;
// scss-docs-end accordion-variables

@layer components {
  .accordion {
    // scss-docs-start accordion-css-vars
    --accordion-color: #{$accordion-color};
    --accordion-bg: #{$accordion-bg};
    --accordion-transition: #{$accordion-transition};
    --accordion-border-color: #{$accordion-border-color};
    --accordion-border-width: #{$accordion-border-width};
    --accordion-border-radius: var(--accordion-radius, var(--border-radius-lg));
    // --accordion-border-radius: #{$accordion-border-radius};
    // --accordion-inner-border-radius: #{$accordion-inner-border-radius};
    --accordion-btn-padding-x: #{$accordion-button-padding-x};
    --accordion-btn-padding-y: #{$accordion-button-padding-y};
    --accordion-btn-color: #{$accordion-button-color};
    --accordion-btn-bg: #{$accordion-button-bg};
    --accordion-btn-icon-width: #{$accordion-icon-width};
    --accordion-btn-icon-transform: #{$accordion-icon-transform};
    --accordion-btn-icon-transition: #{$accordion-icon-transition};
    --accordion-body-padding-x: #{$accordion-body-padding-x};
    --accordion-body-padding-y: #{$accordion-body-padding-y};
    --accordion-active-color: #{$accordion-button-active-color};
    --accordion-active-bg: #{$accordion-button-active-bg};
    // scss-docs-end accordion-css-vars
  }

  .accordion-header {
    display: flex;
    align-items: center;
    width: 100%;
    padding: var(--accordion-btn-padding-y) var(--accordion-btn-padding-x);
    font-size: $font-size-base;
    color: var(--accordion-btn-color);
    text-align: start;
    list-style: none; // Remove default marker
    cursor: pointer;
    background-color: var(--accordion-btn-bg);
    // @include border-radius(var(--accordion-border-radius));
    @include transition(var(--accordion-transition));

    // Hide the default marker in webkit browsers
    // &::-webkit-details-marker {
    //   display: none;
    // }

    // Icon styles
    .accordion-icon {
      flex-shrink: 0;
      width: var(--accordion-btn-icon-width);
      height: var(--accordion-btn-icon-width);
      margin-inline-start: auto;
      color: currentcolor;
      @include transition(var(--accordion-btn-icon-transition));
    }

    &:hover {
      z-index: 2;
    }

    &:focus-visible {
      position: relative;
      z-index: 3;
      @include focus-ring(true);
      outline-offset: -1px;
    }
  }

  .accordion-item {
    color: var(--accordion-color);
    background-color: var(--accordion-bg);
    border: var(--accordion-border-width) solid var(--accordion-border-color);

    &:first-of-type {
      @include border-top-radius(var(--accordion-border-radius));

      > .accordion-header {
        @include border-top-radius(calc(var(--accordion-border-radius) - var(--accordion-border-width)));
      }
    }

    &:not(:first-of-type) {
      border-block-start: 0;
    }

    // Only set a border-radius on the last item if the accordion is collapsed
    &:last-of-type {
      @include border-bottom-radius(var(--accordion-border-radius));

      > .accordion-header {
        @include border-bottom-radius(calc(var(--accordion-border-radius) - var(--accordion-border-width)));
      }

      > .accordion-body {
        @include border-bottom-radius(var(--accordion-border-radius));
      }
    }

    // Open state - details[open] applies these styles
    &[open] {
      border-color: var(--theme-border, var(--accordion-border-color));

      > .accordion-header {
        color: var(--theme-text, var(--accordion-active-color));
        background-color: var(--theme-bg-subtle, var(--accordion-active-bg));
        box-shadow: inset 0 calc(-1 * var(--accordion-border-width)) 0 var(--theme-border, var(--accordion-border-color));

        .accordion-icon {
          transform: var(--accordion-btn-icon-transform);
        }
      }

      // Remove bottom radius from header when open (even on last item)
      &:last-of-type > .accordion-header {
        @include border-bottom-radius(0);
      }
    }
  }

  .accordion-body {
    padding: var(--accordion-body-padding-y) var(--accordion-body-padding-x);
  }


  // Flush accordion items
  //
  // Remove borders and border-radius to keep accordion items edge-to-edge.

  .accordion-flush {
    > .accordion-item {
      border-inline: 0;
      @include border-radius(0);

      &:first-child {
        border-block-start: 0;
      }

      &:last-child {
        border-block-end: 0;
      }

      > .accordion-header,
      > .accordion-body {
        @include border-radius(0);
      }
    }
  }
}
