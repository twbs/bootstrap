@use "config" as *;
@use "variables" as *;
@use "functions" as *;
@use "mixins/border-radius" as *;
@use "mixins/transition" as *;
@use "mixins/focus-ring" as *;
@use "mixins/color-mode" as *;
@use "buttons/button-variables" as *; // mdo-do: remove?

// scss-docs-start accordion-variables
$accordion-padding-y:                     1rem !default;
$accordion-padding-x:                     1.25rem !default;
$accordion-color:                         var(--color-body) !default;
$accordion-bg:                            var(--bg-body) !default;
$accordion-border-width:                  var(--border-width) !default;
$accordion-border-color:                  var(--border-color) !default;
$accordion-border-radius:                 var(--border-radius-lg) !default;
$accordion-inner-border-radius:           calc(#{$accordion-border-radius} - #{$accordion-border-width}) !default;

$accordion-body-padding-y:                $accordion-padding-y !default;
$accordion-body-padding-x:                $accordion-padding-x !default;

$accordion-button-padding-y:              $accordion-padding-y !default;
$accordion-button-padding-x:              $accordion-padding-x !default;
$accordion-button-color:                  var(--fg-2) !default;
$accordion-button-bg:                     var(--accordion-bg) !default;
$accordion-transition:                    $btn-transition, border-radius .15s ease !default;
$accordion-button-active-bg:              var(--bg-2) !default;
$accordion-button-active-color:           var(--fg) !default;

$accordion-icon-width:                    1.25rem !default;
$accordion-icon-transition:               transform .2s ease-in-out !default;
$accordion-icon-transform:                rotate(-180deg) !default;
$accordion-button-icon:         url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='#000' stroke-linecap='round' stroke-linejoin='round'><path d='m2 5 6 6 6-6'/></svg>") !default;
// scss-docs-end accordion-variables

@layer componenents {
  .accordion {
    // scss-docs-start accordion-css-vars
    --accordion-color: #{$accordion-color};
    --accordion-bg: #{$accordion-bg};
    --accordion-transition: #{$accordion-transition};
    --accordion-border-color: #{$accordion-border-color};
    --accordion-border-width: #{$accordion-border-width};
    --accordion-border-radius: #{$accordion-border-radius};
    --accordion-inner-border-radius: #{$accordion-inner-border-radius};
    --accordion-btn-padding-x: #{$accordion-button-padding-x};
    --accordion-btn-padding-y: #{$accordion-button-padding-y};
    --accordion-btn-color: #{$accordion-button-color};
    --accordion-btn-bg: #{$accordion-button-bg};
    --accordion-btn-icon: #{escape-svg($accordion-button-icon)};
    --accordion-btn-icon-width: #{$accordion-icon-width};
    --accordion-btn-icon-transform: #{$accordion-icon-transform};
    --accordion-btn-icon-transition: #{$accordion-icon-transition};
    --accordion-body-padding-x: #{$accordion-body-padding-x};
    --accordion-body-padding-y: #{$accordion-body-padding-y};
    --accordion-active-color: #{$accordion-button-active-color};
    --accordion-active-bg: #{$accordion-button-active-bg};
    // scss-docs-end accordion-css-vars
  }

  .accordion-button {
    position: relative;
    display: flex;
    align-items: center;
    width: 100%;
    padding: var(--accordion-btn-padding-y) var(--accordion-btn-padding-x);
    font-size: $font-size-base;
    color: var(--accordion-btn-color);
    text-align: start; // Reset button style
    background-color: var(--accordion-btn-bg);
    border: 0;
    @include border-radius(0);
    overflow-anchor: none;
    @include transition(var(--accordion-transition));

    &:not(.collapsed) {
      color: var(--accordion-active-color);
      background-color: var(--accordion-active-bg);
      box-shadow: inset 0 calc(-1 * var(--accordion-border-width)) 0 var(--accordion-border-color);

      &::after {
        background-image: var(--accordion-btn-active-icon);
        transform: var(--accordion-btn-icon-transform);
      }
    }

    // Accordion icon
    &::after {
      flex-shrink: 0;
      width: var(--accordion-btn-icon-width);
      height: var(--accordion-btn-icon-width);
      margin-inline-start: auto;
      content: "";
      background-color: var(--accordion-btn-color);
      mask: var(--accordion-btn-icon) no-repeat center 100%;
      @include transition(var(--accordion-btn-icon-transition));
    }

    &:hover {
      z-index: 2;
    }

    &:focus-visible {
      z-index: 3;
      @include focus-ring(true);
    }
  }

  .accordion-header {
    margin-bottom: 0;
  }

  .accordion-item {
    color: var(--accordion-color);
    background-color: var(--accordion-bg);
    border: var(--accordion-border-width) solid var(--accordion-border-color);

    &:first-of-type {
      @include border-top-radius(var(--accordion-border-radius));

      > .accordion-header .accordion-button {
        @include border-top-radius(var(--accordion-inner-border-radius));
      }
    }

    &:not(:first-of-type) {
      border-block-start: 0;
    }

    // Only set a border-radius on the last item if the accordion is collapsed
    &:last-of-type {
      @include border-bottom-radius(var(--accordion-border-radius));

      > .accordion-header .accordion-button {
        &.collapsed {
          @include border-bottom-radius(var(--accordion-inner-border-radius));
        }
      }

      > .accordion-collapse {
        @include border-bottom-radius(var(--accordion-border-radius));
      }
    }
  }

  .accordion-body {
    padding: var(--accordion-body-padding-y) var(--accordion-body-padding-x);
  }


  // Flush accordion items
  //
  // Remove borders and border-radius to keep accordion items edge-to-edge.

  .accordion-flush {
    > .accordion-item {
      border-inline: 0;
      @include border-radius(0);

      &:first-child { border-block-start: 0; }
      &:last-child { border-block-end: 0; }

      // stylelint-disable selector-max-class
      > .accordion-collapse,
      > .accordion-header .accordion-button,
      > .accordion-header .accordion-button.collapsed {
        @include border-radius(0);
      }
      // stylelint-enable selector-max-class
    }
  }

  // @if $enable-dark-mode {
  //   @include color-mode(dark) {
  //     .accordion-button::after {
  //       --accordion-btn-icon: #{escape-svg($accordion-button-icon-dark)};
  //       --accordion-btn-active-icon: #{escape-svg($accordion-button-active-icon-dark)};
  //     }
  //   }
  // }
}
