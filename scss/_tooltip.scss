@use "config" as *;
@use "variables" as *;
@use "mixins/border-radius" as *;
@use "mixins/deprecate" as *;
@use "vendor/rfs" as *;
@use "mixins/reset-text" as *;

// scss-docs-start tooltip-variables
$tooltip-font-size:                 $font-size-sm !default;
$tooltip-max-width:                 200px !default;
$tooltip-color:                     var(--#{$prefix}body-bg) !default;
$tooltip-bg:                        var(--#{$prefix}emphasis-color) !default;
$tooltip-border-radius:             var(--#{$prefix}border-radius) !default;
$tooltip-opacity:                   .9 !default;
$tooltip-padding-y:                 $spacer * .25 !default;
$tooltip-padding-x:                 $spacer * .5 !default;

$tooltip-arrow-width:               .8rem !default;
$tooltip-arrow-height:              .4rem !default;
// scss-docs-end tooltip-variables

// Form tooltips must come after regular tooltips
// scss-docs-start tooltip-feedback-variables
$form-feedback-tooltip-padding-y:     $tooltip-padding-y !default;
$form-feedback-tooltip-padding-x:     $tooltip-padding-x !default;
$form-feedback-tooltip-font-size:     $tooltip-font-size !default;
$form-feedback-tooltip-line-height:   null !default;
$form-feedback-tooltip-opacity:       $tooltip-opacity !default;
$form-feedback-tooltip-border-radius: $tooltip-border-radius !default;
// scss-docs-end tooltip-feedback-variables


@layer components {
  .tooltip {
    // scss-docs-start tooltip-css-vars
    --#{$prefix}tooltip-zindex: #{$zindex-tooltip};
    --#{$prefix}tooltip-max-width: #{$tooltip-max-width};
    --#{$prefix}tooltip-padding-x: #{$tooltip-padding-x};
    --#{$prefix}tooltip-padding-y: #{$tooltip-padding-y};
    @include rfs($tooltip-font-size, --#{$prefix}tooltip-font-size);
    --#{$prefix}tooltip-color: #{$tooltip-color};
    --#{$prefix}tooltip-bg: #{$tooltip-bg};
    --#{$prefix}tooltip-border-radius: #{$tooltip-border-radius};
    --#{$prefix}tooltip-opacity: #{$tooltip-opacity};
    --#{$prefix}tooltip-arrow-width: #{$tooltip-arrow-width};
    --#{$prefix}tooltip-arrow-height: #{$tooltip-arrow-height};
    // scss-docs-end tooltip-css-vars

    position: absolute;
    top: 0;
    left: 0;
    z-index: var(--#{$prefix}tooltip-zindex);
    display: block;
    padding: var(--#{$prefix}tooltip-arrow-height);
    // Our parent element can be arbitrary since tooltips are by default inserted as a sibling of their target element.
    // So reset our font and text properties to avoid inheriting weird values.
    @include reset-text();
    @include font-size(var(--#{$prefix}tooltip-font-size));
    // Allow breaking very long words so they don't overflow the tooltip's bounds
    word-wrap: break-word;
    opacity: 0;

    &.show { opacity: var(--#{$prefix}tooltip-opacity); }

    &::before {
      position: absolute;
      content: "";
      border-color: transparent;
      border-style: solid;
      transform: translateX(-50%);
    }
  }

  .tooltip[data-bs-placement="top"]::before {
    bottom: 0;
    left: 50%;
    border-width: var(--#{$prefix}tooltip-arrow-height) calc(var(--#{$prefix}tooltip-arrow-width) * .5) 0;
    border-top-color: var(--#{$prefix}tooltip-bg);
  }

  .tooltip[data-bs-placement="bottom"]::before {
    top: 0;
    left: 50%;
    border-width: 0 calc(var(--#{$prefix}tooltip-arrow-width) * .5) var(--#{$prefix}tooltip-arrow-height);
    border-bottom-color: var(--#{$prefix}tooltip-bg);
  }

  .tooltip[data-bs-placement="right"]::before {
    top: 50%;
    left: 0;
    border-width: calc(var(--#{$prefix}tooltip-arrow-width) * .5) var(--#{$prefix}tooltip-arrow-height) calc(var(--#{$prefix}tooltip-arrow-width) * .5) 0;
    border-right-color: var(--#{$prefix}tooltip-bg);
    transform: translateY(-50%);
  }

  .tooltip[data-bs-placement="left"]::before {
    top: 50%;
    right: 0;
    border-width: calc(var(--#{$prefix}tooltip-arrow-width) * .5) 0 calc(var(--#{$prefix}tooltip-arrow-width) * .5) var(--#{$prefix}tooltip-arrow-height);
    border-left-color: var(--#{$prefix}tooltip-bg);
    transform: translateY(-50%);
  }

  // Wrapper for the tooltip content
  .tooltip-inner {
    max-width: var(--#{$prefix}tooltip-max-width);
    padding: var(--#{$prefix}tooltip-padding-y) var(--#{$prefix}tooltip-padding-x);
    color: var(--#{$prefix}tooltip-color);
    text-align: center;
    background-color: var(--#{$prefix}tooltip-bg);
    @include border-radius(var(--#{$prefix}tooltip-border-radius));
  }
}
