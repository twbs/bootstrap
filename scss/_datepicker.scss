// Datepicker
//
// Bootstrap wrapper for vanilla-calendar-pro
// Base styles from vanilla-calendar-pro v3.0.5, adapted for Bootstrap

@use "config" as *;
@use "colors" as *;
@use "variables" as *;

// scss-docs-start datepicker-variables
$datepicker-padding:                1rem !default;
$datepicker-bg:                     var(--bg-body) !default;
$datepicker-color:                  var(--color-body) !default;
$datepicker-border-color:           var(--border-color) !default;
$datepicker-border-width:           var(--border-width) !default;
$datepicker-border-radius:          var(--border-radius-lg) !default;
$datepicker-box-shadow:             var(--box-shadow) !default;
$datepicker-font-size:              var(--font-size-sm) !default;
$datepicker-min-width:              272px !default;

$datepicker-header-font-weight:     700 !default;
$datepicker-weekday-color:          var(--secondary-text) !default;
$datepicker-day-hover-bg:           var(--tertiary-bg) !default;
$datepicker-day-selected-bg:        var(--primary-bg) !default;
$datepicker-day-selected-color:     var(--primary-contrast) !default;
$datepicker-day-today-bg:           var(--secondary-bg) !default;
$datepicker-day-today-color:        var(--primary-text) !default;
$datepicker-day-disabled-color:     var(--tertiary-text) !default;
// scss-docs-end datepicker-variables

@layer components {
  // scss-docs-start datepicker-css-vars
  [data-vc="calendar"] {
    --datepicker-padding: #{$datepicker-padding};
    --datepicker-bg: #{$datepicker-bg};
    --datepicker-color: #{$datepicker-color};
    --datepicker-border-color: #{$datepicker-border-color};
    --datepicker-border-width: #{$datepicker-border-width};
    --datepicker-border-radius: #{$datepicker-border-radius};
    --datepicker-box-shadow: #{$datepicker-box-shadow};
    --datepicker-font-size: #{$datepicker-font-size};
    --datepicker-min-width: #{$datepicker-min-width};
    --datepicker-zindex: #{$zindex-dropdown};

    --datepicker-header-font-weight: #{$datepicker-header-font-weight};
    --datepicker-weekday-color: #{$datepicker-weekday-color};
    --datepicker-day-hover-bg: #{$datepicker-day-hover-bg};
    --datepicker-day-selected-bg: #{$datepicker-day-selected-bg};
    --datepicker-day-selected-color: #{$datepicker-day-selected-color};
    --datepicker-day-today-bg: #{$datepicker-day-today-bg};
    --datepicker-day-today-color: #{$datepicker-day-today-color};
    --datepicker-day-disabled-color: #{$datepicker-day-disabled-color};
    // scss-docs-end datepicker-css-vars

    border-radius: var(--datepicker-border-radius);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    min-width: var(--datepicker-min-width);
    opacity: 1;
    padding: var(--datepicker-padding);
    position: relative;
    transition: opacity .15s ease-in-out;
    font-family: var(--font-sans-serif);
    font-size: var(--datepicker-font-size);
    background-color: var(--datepicker-bg);
    color: var(--datepicker-color);
    border: var(--datepicker-border-width) solid var(--datepicker-border-color);
    box-shadow: var(--datepicker-box-shadow);
    z-index: var(--datepicker-zindex);

    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }
  }

  [data-vc="calendar"]:focus-visible,
  [data-vc="calendar"] button:focus-visible,
  [data-vc="calendar"] [tabindex="0"]:focus-visible {
    border-radius: $border-radius;
    outline: 0;
    box-shadow: $focus-ring-box-shadow;
  }

  [data-vc="calendar"][data-vc-calendar-hidden] {
    opacity: 0;
    pointer-events: none;
  }

  [data-vc="calendar"][data-vc-input] {
    position: absolute;
  }

  [data-vc="calendar"][data-vc-input][data-vc-position="bottom"] {
    margin-top: .25rem;
  }

  [data-vc="calendar"][data-vc-input][data-vc-position="top"] {
    margin-top: -.25rem;
  }

  // Controls (arrows)
  [data-vc="controls"] {
    align-items: center;
    box-sizing: content-box;
    display: flex;
    justify-content: space-between;
    left: 0;
    padding-left: 1rem;
    padding-right: 1rem;
    padding-top: 1.25rem;
    pointer-events: none;
    position: absolute;
    right: 0;
    top: 0;
    z-index: 20;
  }

  [data-vc-arrow] {
    background-color: transparent;
    border: 0;
    cursor: pointer;
    display: block;
    height: 1.5rem;
    pointer-events: auto;
    position: relative;
    width: 1.5rem;
    border-radius: $border-radius;
    color: var(--datepicker-color);

    &::before {
      background-position: center;
      background-repeat: no-repeat;
      content: "";
      height: 100%;
      left: 0;
      position: absolute;
      top: 0;
      width: 100%;
      background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='%236b7280' d='M12 16c-.3 0-.5-.1-.7-.3l-6-6c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l5.3 5.3 5.3-5.3c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-6 6c-.2.2-.4.3-.7.3'/></svg>");
    }

    &:hover {
      background-color: var(--datepicker-day-hover-bg);
    }
  }

  [data-vc-arrow="prev"]::before {
    transform: rotate(90deg);
  }

  [data-vc-arrow="next"]::before {
    transform: rotate(-90deg);
  }

  // Grid layout
  [data-vc="grid"] {
    display: flex;
    flex-grow: 1;
    flex-wrap: wrap;
    gap: 1.75rem;
  }

  [data-vc="column"] {
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    min-width: 240px;
  }

  // Header
  [data-vc="header"] {
    align-items: center;
    display: flex;
    margin-bottom: .75rem;
    position: relative;
  }

  [data-vc-header="content"] {
    align-items: center;
    display: grid;
    flex-grow: 1;
    grid-auto-columns: max-content;
    grid-auto-flow: column;
    justify-content: center;
    padding-left: 1rem;
    padding-right: 1rem;
    white-space: pre-wrap;
  }

  [data-vc="month"],
  [data-vc="year"] {
    background-color: transparent;
    border: 0;
    border-radius: $border-radius;
    cursor: pointer;
    font-size: 1rem;
    font-weight: var(--datepicker-header-font-weight);
    line-height: 1.5rem;
    padding: .25rem;
    color: var(--datepicker-color);

    &:disabled {
      pointer-events: none;
      color: var(--datepicker-day-disabled-color);
    }

    &:hover:not(:disabled) {
      background-color: var(--datepicker-day-hover-bg);
    }
  }

  // Content wrapper
  [data-vc="content"],
  [data-vc="wrapper"] {
    display: flex;
    flex-grow: 1;
  }

  [data-vc="content"] {
    flex-direction: column;
  }

  // Month/Year grids
  [data-vc="months"] {
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }

  [data-vc="months"],
  [data-vc="years"] {
    align-items: center;
    column-gap: .25rem;
    display: grid;
    flex-grow: 1;
    row-gap: 1rem;
  }

  [data-vc="years"] {
    grid-template-columns: repeat(5, minmax(0, 1fr));
  }

  [data-vc-months-month],
  [data-vc-years-year] {
    align-items: center;
    background-color: transparent;
    border: 0;
    border-radius: $border-radius;
    cursor: pointer;
    display: flex;
    font-size: .75rem;
    font-weight: 600;
    height: 2.5rem;
    justify-content: center;
    line-height: 1rem;
    padding: .25rem;
    text-align: center;
    word-break: break-all;
    color: var(--datepicker-weekday-color);

    &:disabled {
      pointer-events: none;
      color: var(--datepicker-day-disabled-color);
    }

    &:hover:not(:disabled) {
      background-color: var(--datepicker-day-hover-bg);
    }

    &[data-vc-months-month-selected],
    &[data-vc-years-year-selected] {
      background-color: var(--datepicker-day-selected-bg);
      color: var(--datepicker-day-selected-color);

      &:hover {
        background-color: var(--datepicker-day-selected-bg);
        color: var(--datepicker-day-selected-color);
      }
    }
  }

  // Week numbers
  [data-vc-week="numbers"] {
    display: flex;
    flex-direction: column;
  }

  [data-vc-week-numbers="title"] {
    align-items: center;
    display: flex;
    font-size: .75rem;
    font-weight: 700;
    justify-content: center;
    line-height: 1rem;
    margin-bottom: .5rem;
  }

  [data-vc-week-numbers="content"] {
    align-items: center;
    display: grid;
    grid-auto-flow: row;
    justify-items: center;
    row-gap: .25rem;
  }

  [data-vc-week-number] {
    align-items: center;
    background-color: transparent;
    border: 0;
    cursor: pointer;
    display: flex;
    font-size: .75rem;
    font-weight: 600;
    justify-content: center;
    line-height: 1rem;
    margin: 0;
    min-height: 1.875rem;
    min-width: 1.875rem;
    padding: 0;
    width: 100%;
    color: var(--datepicker-weekday-color);
  }

  // Week days header
  [data-vc="week"] {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    justify-items: center;
    margin-bottom: .5rem;
  }

  [data-vc-week-day] {
    align-items: center;
    background-color: transparent;
    border: 0;
    display: flex;
    font-size: .75rem;
    font-weight: 700;
    justify-content: center;
    line-height: 1rem;
    margin: 0;
    min-width: 1.875rem;
    padding: 0;
    width: 100%;
    color: var(--datepicker-weekday-color);
  }

  button[data-vc-week-day] {
    cursor: pointer;
  }

  // Dates grid
  [data-vc="dates"] {
    align-items: center;
    display: grid;
    flex-grow: 1;
    grid-template-columns: repeat(7, 1fr);
    justify-items: center;
    pointer-events: none;
  }

  [data-vc-date] {
    align-items: center;
    display: flex;
    justify-content: center;
    padding-bottom: .125rem;
    padding-top: .125rem;
    pointer-events: auto;
    position: relative;
    width: 100%;
  }

  [data-vc-date]:not(:has([data-vc-date-btn])),
  [data-vc-date][data-vc-date-disabled],
  [data-vc-date][data-vc-date-disabled] [data-vc-date-btn] {
    pointer-events: none;
  }

  // Date button
  [data-vc-date-btn] {
    align-items: center;
    background-color: transparent;
    border: 0;
    border-radius: $border-radius;
    cursor: pointer;
    display: flex;
    font-size: .75rem;
    font-weight: 400;
    height: 100%;
    justify-content: center;
    line-height: 1rem;
    min-height: 1.875rem;
    min-width: 1.875rem;
    padding: 0;
    transition: background-color .15s ease-in-out, color .15s ease-in-out;
    width: 100%;
    color: var(--datepicker-color);

    &:hover {
      background-color: var(--datepicker-day-hover-bg);
    }
  }

  // Today
  [data-vc-date][data-vc-date-today] [data-vc-date-btn] {
    font-weight: 700;
    background-color: var(--datepicker-day-today-bg);
    color: var(--datepicker-day-today-color);
  }

  // Selected
  [data-vc-date][data-vc-date-selected] [data-vc-date-btn] {
    background-color: var(--datepicker-day-selected-bg);
    color: var(--datepicker-day-selected-color);

    &:hover {
      background-color: var(--datepicker-day-selected-bg);
      color: var(--datepicker-day-selected-color);
    }
  }

  // Outside month
  [data-vc-date][data-vc-date-month="next"] [data-vc-date-btn],
  [data-vc-date][data-vc-date-month="prev"] [data-vc-date-btn] {
    opacity: .5;
  }

  // Disabled
  [data-vc-date][data-vc-date-disabled] [data-vc-date-btn] {
    color: var(--datepicker-day-disabled-color);
  }

  // Range selection styles
  [data-vc-date][data-vc-date-hover] [data-vc-date-btn] {
    border-radius: 0;
    background-color: var(--datepicker-day-hover-bg);
  }

  [data-vc-date][data-vc-date-hover="first"] [data-vc-date-btn] {
    border-top-left-radius: $border-radius;
    border-bottom-left-radius: $border-radius;
  }

  [data-vc-date][data-vc-date-hover="last"] [data-vc-date-btn] {
    border-top-right-radius: $border-radius;
    border-bottom-right-radius: $border-radius;
  }

  [data-vc-date][data-vc-date-hover="first-and-last"] [data-vc-date-btn] {
    border-radius: $border-radius;
  }

  [data-vc-date][data-vc-date-selected="middle"] [data-vc-date-btn] {
    border-radius: 0;
    opacity: .8;
  }

  [data-vc-date][data-vc-date-selected="first"] [data-vc-date-btn] {
    border-top-left-radius: $border-radius;
    border-bottom-left-radius: $border-radius;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }

  [data-vc-date][data-vc-date-selected="last"] [data-vc-date-btn] {
    border-top-right-radius: $border-radius;
    border-bottom-right-radius: $border-radius;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  [data-vc-date][data-vc-date-selected="first-and-last"] [data-vc-date-btn] {
    border-radius: $border-radius;
  }
}
